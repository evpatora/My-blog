[{"authors":["admin"],"categories":null,"content":"I am a PhD student at the Department of Clinical Epidemiology, Aarhus University. I conduct research in reproductive health focusing on abortive or near abortive events in pregnancy and their effects on the long-term health of the children and women. I am interested in pharmacoepidemiology, especially drug utilization and safety in pregnancy. I am passionate about causal inference and R stats.\n","date":1595203200,"expirydate":-62135596800,"kind":"term","lang":"en","lastmod":1595203200,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"/author/elena-dudukina/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/author/elena-dudukina/","section":"authors","summary":"I am a PhD student at the Department of Clinical Epidemiology, Aarhus University. I conduct research in reproductive health focusing on abortive or near abortive events in pregnancy and their effects on the long-term health of the children and women.","tags":null,"title":"Elena Dudukina","type":"authors"},{"authors":null,"categories":["R"],"content":"Nordic open access databases Nordic countries have databases with national aggregated data on, e.g. drug utilization, openly available. These databases are a great asset - you can investigate national trends for your curiosity or for research.\nThe databases are easily accessible and well-maintained. In this blog post, I will be taking a look at the Swedish aggregated drug utilization database.\nWhy I wrote this post? The databases have a lot of useful features incorporated in a web interface, however it is not always sufficiently flexible to satisfy certain research tasks (in my personal experience). Ticking boxes is fun but - oh no - I selected one age category more than I intended, start again\u0026hellip;üôà It may be a frustrating experience when you need a quick and efficient check üëÄ or when you perform multiple checks, for which reproducibility matters a lot.\nWhat this post will cover? This post will be focused on Swedish national trends of antidepressants, antipsychotics, anxiolytics, and sedatives utilization in women. I compare Swedish and Danish national trends of utilization of these medications in part II.\nLet\u0026rsquo;s go!üá∏üá™\nlibrary(tidyverse) library(magrittr) library(wesanderson)  # I will keep only ATC codes I am interested in regex_antidepress \u0026lt;- \u0026quot;^N06A$\u0026quot; regex_antipsych \u0026lt;- \u0026quot;^N05A$\u0026quot; regex_anxiolyt \u0026lt;- \u0026quot;^N05B$\u0026quot; regex_sedat \u0026lt;- \u0026quot;^N05C$\u0026quot; # combine all ATC codes in one regex string all_regex \u0026lt;- paste(regex_sedat, regex_antipsych, regex_antidepress, regex_anxiolyt, sep = \u0026quot;|\u0026quot;)  I use \u0026ldquo;CSV Statistics Database - Medicines 2006‚Äì2019\u0026rdquo; data from here.\nFirst, I will have a look at the data files. I will store .csv data files as a list and will name each element inside the list according to .csv file name.\n# name the list elements according the name of downloaded .csv files # path_se is your path with the downloaded and unzipped .csv files file_names_se \u0026lt;- list.files(path = path_se, pattern = \u0026quot;.csv\u0026quot;) # load the data files all_files_se \u0026lt;- map(file_names_se, ~read_delim(file = paste0(path_se, .x), trim_ws = T, delim = \u0026quot;;\u0026quot;)) %\u0026gt;% # I expect that formatting of numbers in the files may not be standard; I re-formar all columns to character type to deal with numbers' formatting later map(~mutate_all(.x, as.character))  The files containing the drug utilization per year include columns:\n Characteristic Year Region ATC Sex Age Value  all_files_se[[1]] %\u0026gt;% slice(1:5)  ## # A tibble: 5 x 7 ## M√•tt √Ör Region `ATC¬≠kod` K√∂n √Ölder V√§rde ## \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; ## 1 3 2006 0 TOTALT 1 1 560858 ## 2 3 2006 0 TOTALT 1 2 413587 ## 3 3 2006 0 TOTALT 1 3 415480 ## 4 3 2006 0 TOTALT 1 4 474248 ## 5 3 2006 0 TOTALT 1 5 444933  # Note the region coded as integer 0, 1, 2  Before moving forward, I want to combine drug utilization data with meta-data files.\n# age all_files_se[[71]] %\u0026gt;% slice(1:5)  ## # A tibble: 5 x 2 ## √Ölder Text ## \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; ## 1 1 0-4 ## 2 2 5-9 ## 3 3 10-14 ## 4 4 15-19 ## 5 5 20-24  # ATC codes all_files_se[[72]] %\u0026gt;% slice(1:5)  ## # A tibble: 5 x 2 ## ATC Text ## \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; ## 1 TOTALT Samtliga (A - V) ## 2 A Matsm√§ltningsorgan och √§mnesoms√§ttning ## 3 A01 Medel vid mun- och tandsjukdomar ## 4 A01A Medel vid mun- och tandsjukdomar ## 5 A01AA Medel mot karies  # Sex all_files_se[[73]] %\u0026gt;% slice(1:5)  ## # A tibble: 3 x 2 ## K√∂n Text ## \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; ## 1 1 M√§n ## 2 2 Kvinnor ## 3 3 B√•da k√∂nen  # Characteristic/stats all_files_se[[74]] %\u0026gt;% slice(1:5)  ## # A tibble: 5 x 2 ## M√•tt Text ## \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; ## 1 1 Antal patienter ## 2 2 Patienter/1000 inv√•nare ## 3 3 Antal expedieringar ## 4 4 Expedieringar/1000 inv√•nare ## 5 9 Befolkning  # Region all_files_se[[75]] %\u0026gt;% slice(1:5)  ## # A tibble: 5 x 2 ## Region Text ## \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; ## 1 00 Riket ## 2 01 Stockholms l√§n ## 3 03 Uppsala l√§n ## 4 04 S√∂dermanlands l√§n ## 5 05 √ñsterg√∂tlands l√§n  # Note the region coded as 00, 01, 02 in the meta-data file and 0, 1, 2 in the files with stats  I am not speaking Swedish and it takes a moment to remember what some of the columns mean and which values are sensible.\n# recode regions so that the coding in the meta-data file matches the stats data all_files_se[[75]] %\u0026lt;\u0026gt;% mutate(Region = as.character(as.numeric(Region)))  # combine with meta-data data_se \u0026lt;- bind_rows(all_files_se[c(1:70)]) %\u0026gt;% # join with age groups labels left_join(all_files_se[[71]]) %\u0026gt;% # rename joined column to age_group rename(age_group = Text) %\u0026gt;% # rename ATCkod to ATC rename(ATC = 4) %\u0026gt;% # keep only ATC codes of interest filter(str_detect(string = ATC, pattern = all_regex)) %\u0026gt;% # join with drugs labels left_join(all_files_se[[72]]) %\u0026gt;% # rename joined column rename(drug = Text) %\u0026gt;% # join with sex labels left_join(all_files_se[[73]]) %\u0026gt;% # rename joined column rename(gender = Text) %\u0026gt;% # keep records on drug utilization in women filter(gender == \u0026quot;Kvinnor\u0026quot;) %\u0026gt;% # join with characteristics' labels left_join(all_files_se[[74]]) %\u0026gt;% # rename characteristics' labels column rename(stat = Text) %\u0026gt;% # join with regions' labels column left_join(all_files_se[[75]]) %\u0026gt;% # rename regions' labels column rename(region_text = Text) %\u0026gt;% # keep stats for the whole country filter(region_text == \u0026quot;Riket\u0026quot;) %\u0026gt;% # rename some of the columns in the dataset while selecting columns in the desired order select(year = √Ör, region = region_text, ATC, values = V√§rde, age_group, drug, gender, stat)  data_se %\u0026gt;% slice(1:5)  ## # A tibble: 5 x 8 ## year region ATC values age_group drug gender stat ## \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; ## 1 2006 Riket N05A 3 0-4 Neuroleptika Kvinnor Antal expedieringar ## 2 2006 Riket N05A 138 5-9 Neuroleptika Kvinnor Antal expedieringar ## 3 2006 Riket N05A 922 10-14 Neuroleptika Kvinnor Antal expedieringar ## 4 2006 Riket N05A 6276 15-19 Neuroleptika Kvinnor Antal expedieringar ## 5 2006 Riket N05A 13139 20-24 Neuroleptika Kvinnor Antal expedieringar  # pivot data into wide format so that each stat has its column data_se %\u0026lt;\u0026gt;% pivot_wider(names_from = stat, values_from = values) %\u0026gt;% # format numbers using with dot as a decimal separator mutate( `Expedieringar/1000 inv√•nare` = str_replace_all(string = `Expedieringar/1000 inv√•nare`, pattern = \u0026quot;,\u0026quot;, replacement = \u0026quot;.\u0026quot;), `Patienter/1000 inv√•nare` = str_replace_all(string = `Patienter/1000 inv√•nare`, pattern = \u0026quot;,\u0026quot;, replacement = \u0026quot;.\u0026quot;), `Expedieringar/1000 inv√•nare` = as.numeric(`Expedieringar/1000 inv√•nare`), `Patienter/1000 inv√•nare` = as.numeric(`Patienter/1000 inv√•nare`) ) %\u0026gt;% # all to numeric mutate_at(vars(`Antal expedieringar`, `Antal patienter`, Befolkning, year), as.numeric) data_se %\u0026gt;% slice(1:5)  ## # A tibble: 5 x 11 ## year region ATC age_group drug gender `Antal expedier‚Ä¶ `Antal patiente‚Ä¶ ## \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; ## 1 2006 Riket N05A 0-4 Neur‚Ä¶ Kvinn‚Ä¶ 3 2 ## 2 2006 Riket N05A 5-9 Neur‚Ä¶ Kvinn‚Ä¶ 138 39 ## 3 2006 Riket N05A 10-14 Neur‚Ä¶ Kvinn‚Ä¶ 922 222 ## 4 2006 Riket N05A 15-19 Neur‚Ä¶ Kvinn‚Ä¶ 6276 1209 ## 5 2006 Riket N05A 20-24 Neur‚Ä¶ Kvinn‚Ä¶ 13139 2102 ## # ‚Ä¶ with 3 more variables: Befolkning \u0026lt;dbl\u0026gt;, `Expedieringar/1000 ## # inv√•nare` \u0026lt;dbl\u0026gt;, `Patienter/1000 inv√•nare` \u0026lt;dbl\u0026gt;  I will work with age categories between 20 and 54 years.\n# age categories: check distinct, keep ages of interest ages_to_keep \u0026lt;- data_se %\u0026gt;% distinct(age_group) %\u0026gt;% filter(row_number() %in% 5:11) %\u0026gt;% pull() ages_to_keep  ## [1] \u0026quot;20-24\u0026quot; \u0026quot;25-29\u0026quot; \u0026quot;30-34\u0026quot; \u0026quot;35-39\u0026quot; \u0026quot;40-44\u0026quot; \u0026quot;45-49\u0026quot; \u0026quot;50-54\u0026quot;  # age_cat_1 age_cat_1 \u0026lt;- data_se %\u0026gt;% distinct(age_group) %\u0026gt;% filter(row_number() %in% 5) %\u0026gt;% pull() age_cat_1  ## [1] \u0026quot;20-24\u0026quot;  # age_cat_2 age_cat_2 \u0026lt;- data_se %\u0026gt;% distinct(age_group) %\u0026gt;% filter(row_number() %in% 6:7) %\u0026gt;% pull() age_cat_2  ## [1] \u0026quot;25-29\u0026quot; \u0026quot;30-34\u0026quot;  # age_cat_3 age_cat_3 \u0026lt;- data_se %\u0026gt;% distinct(age_group) %\u0026gt;% filter(row_number() %in% 8:9) %\u0026gt;% pull() age_cat_3  ## [1] \u0026quot;35-39\u0026quot; \u0026quot;40-44\u0026quot;  # age_cat_4 age_cat_4 \u0026lt;- data_se %\u0026gt;% distinct(age_group) %\u0026gt;% filter(row_number() %in% 10:11) %\u0026gt;% pull() age_cat_4  ## [1] \u0026quot;45-49\u0026quot; \u0026quot;50-54\u0026quot;  # final data data_se %\u0026lt;\u0026gt;% filter(age_group %in% ages_to_keep) %\u0026gt;% # group by year and ATC code to aggregate into age categories mutate( age_cat = case_when( age_group %in% age_cat_1 ~ \u0026quot;20-24\u0026quot;, age_group %in% age_cat_2 ~ \u0026quot;25-34\u0026quot;, age_group %in% age_cat_3 ~ \u0026quot;35-44\u0026quot;, age_group %in% age_cat_4 ~ \u0026quot;45-54\u0026quot;, T ~ NA_character_ ) ) %\u0026gt;% # keep only relevant ages filter(! is.na(age_cat)) %\u0026gt;% # to count number of women who received a prescription per ATC code, per age group, per year group_by(ATC, year, age_cat) %\u0026gt;% mutate( # number of patients in the numerator numerator = sum(`Antal patienter`), # population size in the denominator; denominator includes women of particular age category per year denominator = sum(Befolkning), patients_per_1000_inhabitants = numerator / denominator * 1000 ) %\u0026gt;% ungroup() %\u0026gt;% # keep ATC codes of interest only filter(str_detect(string = ATC, pattern = all_regex)) data_se %\u0026gt;% slice(1:5)  ## # A tibble: 5 x 15 ## year region ATC age_group drug gender `Antal expedier‚Ä¶ `Antal patiente‚Ä¶ ## \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; ## 1 2006 Riket N05A 20-24 Neur‚Ä¶ Kvinn‚Ä¶ 13139 2102 ## 2 2006 Riket N05A 25-29 Neur‚Ä¶ Kvinn‚Ä¶ 19561 2539 ## 3 2006 Riket N05A 30-34 Neur‚Ä¶ Kvinn‚Ä¶ 27854 3330 ## 4 2006 Riket N05A 35-39 Neur‚Ä¶ Kvinn‚Ä¶ 40778 4148 ## 5 2006 Riket N05A 40-44 Neur‚Ä¶ Kvinn‚Ä¶ 57630 5328 ## # ‚Ä¶ with 7 more variables: Befolkning \u0026lt;dbl\u0026gt;, `Expedieringar/1000 ## # inv√•nare` \u0026lt;dbl\u0026gt;, `Patienter/1000 inv√•nare` \u0026lt;dbl\u0026gt;, age_cat \u0026lt;chr\u0026gt;, ## # numerator \u0026lt;dbl\u0026gt;, denominator \u0026lt;dbl\u0026gt;, patients_per_1000_inhabitants \u0026lt;dbl\u0026gt;  Results list_plots_se[[1]]  Atidepressants utilization in Swedish women was increasing starting in 2010. In 2019, 104 Swedish women per 1000 female inhabitants aged between 20-24 had a prescription of any antidepressant; 166 Swedish women aged between 45 and 54 years per 1000 female inhabitants in this age category received any antidepressant prescription.\nlist_plots_se[[2]]  Antipsychotics utilization among Swedish women has risen sharply since 2007 for women in the age categories 20-24 years and 25-34 years. In 2019, 15 Swedish women per 1000 aged between 20-24 years, 17 Swedish women per 1000 aged between 25-34 years, 18 Swedish women per 1000 aged between 35-44 years, and 21 Swedish women per 1000 aged between 45-54 years received antipsychotics prescription.\nlist_plots_se[[3]]  Anxiolytics utilization among Swedish women between 20 and 54 years of age was increasing from the beginning of medication utilization data recording in 2006. Starting in 2015, the rates of anxiolytics utilization was decreasing in women of all investigated age categories. In 2019, anxiolytics utilization varied between 46 women per 1000 in age category 20-24 years and 73 women per 1000 in age category 45-54 years.\nlist_plots_se[[4]]  Sedatives utilization among Swedish women was between 44 women per 1000 in age category 20-24 years and 101 women per 1000 in age category 45-54 years. The rates of sedatives utilization remained nearly unchanged between 2006 and 2019 for women aged 45-54 years and was increasing among women between 20 and 44 years of age.\nData caveats  The data do not include medicines that are sold without prescription No data on indication. Medication with the same ATC code with distinct indications will be aggregated \u0026ldquo;Number of patients\u0026rdquo; is the number of individuals who received a drug prescription at least once during the calendar year. For some medications, the \u0026ldquo;number of patients\u0026rdquo; can exceed the actual size of the given population The same individual may receive several prescriptions for different medications and therefore when summing over several drug groups, the same individual will be counted several times  The whole list of aggregated data caveats to keep in mind for Swedish drug utilization data can be found here.\nPlease leave your comments or questions via your preferred social media. All feedback is very much appreciated ‚úå\n","date":1598745600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1598745600,"objectID":"97f43a6356ce62014af32ad4991db938","permalink":"/post/drug-utilization-part-i/2020-08-30-drug-utilization-in-sweden-and-denmark/","publishdate":"2020-08-30T00:00:00Z","relpermalink":"/post/drug-utilization-part-i/2020-08-30-drug-utilization-in-sweden-and-denmark/","section":"post","summary":"Nordic open access databases Nordic countries have databases with national aggregated data on, e.g. drug utilization, openly available. These databases are a great asset - you can investigate national trends for your curiosity or for research.","tags":["Data analysis","Rstats","tidyverse","drug utilization","pharmacoepidemiology"],"title":"Drug utilization in Sweden and Denmark: Part I","type":"post"},{"authors":null,"categories":["R"],"content":"In this part, I will look into the Danish national trends on of sedatives, antidepressants, anti-psychotics and anxiolytics utilization in women. Then I\u0026rsquo;d like to compare Danish national trends with Swedish national trends from Part I.\nlibrary(tidyverse) library(magrittr) library(wesanderson)  First things first - uploading data.\nlink_list_dk \u0026lt;- list( \u0026quot;1996_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MTk5Nl9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;1997_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MTk5N19hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;1998_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MTk5OF9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;1999_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MTk5OV9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2000_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAwMF9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2001_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAwMV9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2002_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAwMl9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2003_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAwM19hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2004_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAwNF9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2006_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAwNl9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2007_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAwN19hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2008_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAwOF9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2009_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAwOV9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2010_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAxMF9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2011_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAxMV9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2012_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAxMl9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2013_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAxM19hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2014_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAxNF9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2015_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAxNV9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2016_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAxNl9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2017_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAxN19hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2018_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAxOF9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;2019_atc_code_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/MjAxOV9hdGNfY29kZV9kYXRhLnR4dA==\u0026quot;, \u0026quot;atc_code_text.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/YXRjX2NvZGVfdGV4dC50eHQ=\u0026quot;, \u0026quot;atc_groups.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/YXRjX2dyb3Vwcy50eHQ=\u0026quot;, \u0026quot;population_data.txt\u0026quot; = \u0026quot;https://medstat.dk/da/download/file/cG9wdWxhdGlvbl9kYXRhLnR4dA==\u0026quot; ) # ATC codes are stored in files seq_atc \u0026lt;- c(1:23) atc_code_data_list \u0026lt;- link_list_dk[seq_atc]  I will compile data on population size, which I may use to compute denominators for drug utilization per capita.\n# age structure data # parse with column type character age_structure \u0026lt;- read_delim(link_list_dk[[\u0026quot;population_data.txt\u0026quot;]], delim = \u0026quot;;\u0026quot;, col_names = c(paste0(\u0026quot;V\u0026quot;, c(1:7))), col_types = cols(V1 = col_character(), V2 = col_character(), V3 = col_character(), V4 = col_character(), V5 = col_character(), V6 = col_character(), V7 = col_character())) %\u0026gt;% # rename and keep columns select(year = V1, region_text = V2, region = V3, gender = V4, age = V5, denominator_per_year = V6) %\u0026gt;% # human-reading friendly label on sex categories mutate( gender_text = case_when( gender == \u0026quot;0\u0026quot; ~ \u0026quot;both sexes\u0026quot;, gender == \u0026quot;1\u0026quot; ~ \u0026quot;men\u0026quot;, gender == \u0026quot;2\u0026quot; ~ \u0026quot;women\u0026quot;, T ~ as.character(gender) ) ) %\u0026gt;% # make numeric variables mutate_at(vars(year, age, denominator_per_year), as.numeric) %\u0026gt;% # keep only data for the age categories I will work with and only on women filter(age %in% 20:54, gender == \u0026quot;2\u0026quot;) %\u0026gt;% arrange(year, age, region, gender) age_structure %\u0026gt;% slice(1:10)  ## # A tibble: 10 x 7 ## year region_text region gender age denominator_per_year gender_text ## \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; ## 1 1996 DK 0 2 20 36363 women ## 2 1996 DK 0 2 21 36366 women ## 3 1996 DK 0 2 22 36498 women ## 4 1996 DK 0 2 23 38452 women ## 5 1996 DK 0 2 24 37873 women ## 6 1996 DK 0 2 25 36383 women ## 7 1996 DK 0 2 26 36115 women ## 8 1996 DK 0 2 27 37514 women ## 9 1996 DK 0 2 28 40669 women ## 10 1996 DK 0 2 29 43619 women  Danish data has a handy file with all drug classes in English, which I intend to use as labels later on.\neng_drug \u0026lt;- read_delim(link_list_dk[[\u0026quot;atc_groups.txt\u0026quot;]], delim = \u0026quot;;\u0026quot;, col_names = c(paste0(\u0026quot;V\u0026quot;, c(1:6))), col_types = cols(V1 = col_character(), V2 = col_character(), V3 = col_character(), V4 = col_character(), V5 = col_character(), V6 = col_character())) %\u0026gt;% # keep drug classes labels in English filter(V5 == \u0026quot;1\u0026quot;) %\u0026gt;% select(ATC = V1, drug = V2, unit_dk = V4) eng_drug %\u0026gt;% slice(1:10)  ## # A tibble: 10 x 3 ## ATC drug unit_dk ## \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; ## 1 A Alimentary tract and metabolism No common unit for volume ## 2 A01 Stomatological preparations No common unit for volume ## 3 A01A Stomatological preparations No common unit for volume ## 4 A01AA Caries prophylactic agents Packages ## 5 A01AA01 Sodium fluoride Packages ## 6 A01AB Antiinfectives for local oral treatment No common unit for volume ## 7 A01AB02 Hydrogenperoxide \u0026lt;NA\u0026gt; ## 8 A01AB03 Chlorhexidine DDD ## 9 A01AB04 Amphotericin DDD ## 10 A01AB09 Miconazole DDD  I keep only ATC codes I am interested in. I use $ in the end of each regular expression (regex) to make sure that I capture the widest ATC code category, which already encompasses all the subcategories. Hypnotics and sedatives - N05C already aggregates N05CA, N05CB, N05CC, N05CD, N05CE, N05CF, N05CH ATC codes.\nregex_antidepress \u0026lt;- \u0026quot;^N06A$\u0026quot; regex_antipsych \u0026lt;- \u0026quot;^N05A$\u0026quot; regex_anxiolyt \u0026lt;- \u0026quot;^N05B$\u0026quot; regex_sedat \u0026lt;- \u0026quot;^N05C$\u0026quot; # combine all ATC codes in one regex string all_regex \u0026lt;- paste(regex_antidepress, regex_antipsych, regex_anxiolyt, regex_sedat, sep = \u0026quot;|\u0026quot;)  # ATC data atc_data \u0026lt;- map(atc_code_data_list, ~read_delim(file = .x, delim = \u0026quot;;\u0026quot;, trim_ws = T, col_names = c(paste0(\u0026quot;V\u0026quot;, c(1:14))), col_types = cols(V1 = col_character(), V2 = col_character(), V3 = col_character(), V4 = col_character(), V5 = col_character(),V6 = col_character(), V7 = col_character(), V8 = col_character(), V9 = col_character(), V10 = col_character(), V11 = col_character(), V12 = col_character(), V13 = col_character(), V14 = col_character()))) %\u0026gt;% # bind data from all years bind_rows() # age categories: in 6 year bands and in each year age_cat_in_6 \u0026lt;- atc_data %\u0026gt;% distinct(V6) %\u0026gt;% filter(row_number() %in% 2:7) %\u0026gt;% pull() age_cat_in_6  ## [1] \u0026quot;00-17\u0026quot; \u0026quot;18-24\u0026quot; \u0026quot;25-44\u0026quot; \u0026quot;45-64\u0026quot; \u0026quot;65-79\u0026quot; \u0026quot;80+\u0026quot;  age_in_years \u0026lt;- atc_data %\u0026gt;% distinct(V6) %\u0026gt;% filter(row_number() %in% 8:103) %\u0026gt;% pull() age_in_years  ## [1] \u0026quot;000\u0026quot; \u0026quot;001\u0026quot; \u0026quot;002\u0026quot; \u0026quot;003\u0026quot; \u0026quot;004\u0026quot; \u0026quot;005\u0026quot; \u0026quot;006\u0026quot; \u0026quot;007\u0026quot; \u0026quot;008\u0026quot; \u0026quot;009\u0026quot; \u0026quot;010\u0026quot; \u0026quot;011\u0026quot; ## [13] \u0026quot;012\u0026quot; \u0026quot;013\u0026quot; \u0026quot;014\u0026quot; \u0026quot;015\u0026quot; \u0026quot;016\u0026quot; \u0026quot;017\u0026quot; \u0026quot;018\u0026quot; \u0026quot;019\u0026quot; \u0026quot;020\u0026quot; \u0026quot;021\u0026quot; \u0026quot;022\u0026quot; \u0026quot;023\u0026quot; ## [25] \u0026quot;024\u0026quot; \u0026quot;025\u0026quot; \u0026quot;026\u0026quot; \u0026quot;027\u0026quot; \u0026quot;028\u0026quot; \u0026quot;029\u0026quot; \u0026quot;030\u0026quot; \u0026quot;031\u0026quot; \u0026quot;032\u0026quot; \u0026quot;033\u0026quot; \u0026quot;034\u0026quot; \u0026quot;035\u0026quot; ## [37] \u0026quot;036\u0026quot; \u0026quot;037\u0026quot; \u0026quot;038\u0026quot; \u0026quot;039\u0026quot; \u0026quot;040\u0026quot; \u0026quot;041\u0026quot; \u0026quot;042\u0026quot; \u0026quot;043\u0026quot; \u0026quot;044\u0026quot; \u0026quot;045\u0026quot; \u0026quot;046\u0026quot; \u0026quot;047\u0026quot; ## [49] \u0026quot;048\u0026quot; \u0026quot;049\u0026quot; \u0026quot;050\u0026quot; \u0026quot;051\u0026quot; \u0026quot;052\u0026quot; \u0026quot;053\u0026quot; \u0026quot;054\u0026quot; \u0026quot;055\u0026quot; \u0026quot;056\u0026quot; \u0026quot;057\u0026quot; \u0026quot;058\u0026quot; \u0026quot;059\u0026quot; ## [61] \u0026quot;060\u0026quot; \u0026quot;061\u0026quot; \u0026quot;062\u0026quot; \u0026quot;063\u0026quot; \u0026quot;064\u0026quot; \u0026quot;065\u0026quot; \u0026quot;066\u0026quot; \u0026quot;067\u0026quot; \u0026quot;068\u0026quot; \u0026quot;069\u0026quot; \u0026quot;070\u0026quot; \u0026quot;071\u0026quot; ## [73] \u0026quot;072\u0026quot; \u0026quot;073\u0026quot; \u0026quot;074\u0026quot; \u0026quot;075\u0026quot; \u0026quot;076\u0026quot; \u0026quot;077\u0026quot; \u0026quot;078\u0026quot; \u0026quot;079\u0026quot; \u0026quot;080\u0026quot; \u0026quot;081\u0026quot; \u0026quot;082\u0026quot; \u0026quot;083\u0026quot; ## [85] \u0026quot;084\u0026quot; \u0026quot;085\u0026quot; \u0026quot;086\u0026quot; \u0026quot;087\u0026quot; \u0026quot;088\u0026quot; \u0026quot;089\u0026quot; \u0026quot;090\u0026quot; \u0026quot;091\u0026quot; \u0026quot;092\u0026quot; \u0026quot;093\u0026quot; \u0026quot;094\u0026quot; \u0026quot;95+\u0026quot;  # clean dataset atc_data %\u0026lt;\u0026gt;% # rename and keep columns rename( ATC = V1, year = V2, sector = V3, region = V4, gender = V5, # 0 - both; 1 - male; 2 - female age = V6, number_of_people = V7, patients_per_1000_inhabitants = V8, turnover = V9, regional_grant_paid = V10, quantity_sold_1000_units = V11, quantity_sold_units_per_unit_1000_inhabitants_per_day = V12, percentage_of_sales_in_the_primary_sector = V13 ) %\u0026gt;% # clean columns names and set-up labels mutate( year = as.numeric(year), region_text = case_when( region == \u0026quot;0\u0026quot; ~ \u0026quot;DK\u0026quot;, region == \u0026quot;1\u0026quot; ~ \u0026quot;Region Hovedstaden\u0026quot;, region == \u0026quot;2\u0026quot; ~ \u0026quot;Region Midtjylland\u0026quot;, region == \u0026quot;3\u0026quot; ~ \u0026quot;Region Nordjylland\u0026quot;, region == \u0026quot;4\u0026quot; ~ \u0026quot;Region Sj√¶lland\u0026quot;, region == \u0026quot;5\u0026quot; ~ \u0026quot;Region Syddanmark\u0026quot;, T ~ NA_character_ ), gender_text = case_when( gender == \u0026quot;0\u0026quot; ~ \u0026quot;both sexes\u0026quot;, gender == \u0026quot;1\u0026quot; ~ \u0026quot;men\u0026quot;, gender == \u0026quot;2\u0026quot; ~ \u0026quot;women\u0026quot;, T ~ as.character(gender) ), age_cats = case_when( age %in% \u0026quot;A\u0026quot; ~ \u0026quot;A\u0026quot;, age %in% age_cat_in_6 ~ \u0026quot;6 years\u0026quot;, age %in% age_in_years ~ \u0026quot;yearly categories\u0026quot;, age %in% \u0026quot;T\u0026quot; ~ \u0026quot;T\u0026quot;, T ~ NA_character_ ) ) %\u0026gt;% mutate_at(vars(turnover, regional_grant_paid, quantity_sold_1000_units, quantity_sold_units_per_unit_1000_inhabitants_per_day, number_of_people, patients_per_1000_inhabitants), as.numeric) %\u0026gt;% select(-V14) %\u0026gt;% filter( age_cats == \u0026quot;yearly categories\u0026quot;, gender == \u0026quot;2\u0026quot;, region == \u0026quot;0\u0026quot;, sector ==\u0026quot;0\u0026quot; ) %\u0026gt;% filter(str_detect(ATC, all_regex)) %\u0026gt;% # deal with non-numeric age and re-code as numeric mutate( age = case_when( age == \u0026quot;95+\u0026quot; ~ \u0026quot;95\u0026quot;, T ~ as.character(age) ), age = as.numeric(age) ) %\u0026gt;% filter(age %in% 20:54) %\u0026gt;% mutate( age_cat = case_when( age %in% 20:24 ~ \u0026quot;20-24\u0026quot;, age %in% 25:34 ~ \u0026quot;25-34\u0026quot;, age %in% 35:44 ~ \u0026quot;35-44\u0026quot;, age %in% 45:54 ~ \u0026quot;45-54\u0026quot;, T ~ NA_character_ ) ) %\u0026gt;% left_join(age_structure) %\u0026gt;% group_by(ATC, year, age_cat) %\u0026gt;% mutate( numerator = sum(number_of_people), denominator = sum(denominator_per_year), patients_per_1000_inhabitants = numerator / denominator * 1000 ) %\u0026gt;% filter(row_number() == 1) %\u0026gt;% ungroup() %\u0026gt;% select(year, ATC, gender, age_cat, patients_per_1000_inhabitants) %\u0026gt;% mutate( country = \u0026quot;Denmark\u0026quot; )  ## Joining, by = c(\u0026quot;year\u0026quot;, \u0026quot;region\u0026quot;, \u0026quot;gender\u0026quot;, \u0026quot;age\u0026quot;, \u0026quot;region_text\u0026quot;, \u0026quot;gender_text\u0026quot;)  atc_data %\u0026gt;% slice(1:10)  ## # A tibble: 10 x 6 ## year ATC gender age_cat patients_per_1000_inhabitants country ## \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; ## 1 1999 N05A 2 20-24 5.60 Denmark ## 2 1999 N05A 2 25-34 9.71 Denmark ## 3 1999 N05A 2 35-44 19.9 Denmark ## 4 1999 N05A 2 45-54 29.4 Denmark ## 5 1999 N05B 2 20-24 12.5 Denmark ## 6 1999 N05B 2 25-34 26.3 Denmark ## 7 1999 N05B 2 35-44 61.7 Denmark ## 8 1999 N05B 2 45-54 106. Denmark ## 9 1999 N05C 2 20-24 7.86 Denmark ## 10 1999 N05C 2 25-34 18.0 Denmark  # combine Swedish data from previous post and Danish data data \u0026lt;- data_se %\u0026gt;% select(year, ATC, gender, age_cat, patients_per_1000_inhabitants) %\u0026gt;% mutate( country = \u0026quot;Sweden\u0026quot; ) %\u0026gt;% full_join(atc_data) %\u0026gt;% # join with ATC classes labels in English left_join(eng_drug)  ## Joining, by = c(\u0026quot;year\u0026quot;, \u0026quot;ATC\u0026quot;, \u0026quot;gender\u0026quot;, \u0026quot;age_cat\u0026quot;, \u0026quot;patients_per_1000_inhabitants\u0026quot;, \u0026quot;country\u0026quot;)  ## Joining, by = \u0026quot;ATC\u0026quot;  To avoid copy-pasting the same ggplot code, I use a wrapper around the plotting function.\nplot_utilization \u0026lt;- function(data, drug_regex, title){ data %\u0026gt;% filter(str_detect(ATC, {{ drug_regex }})) %\u0026gt;% group_by(country) %\u0026gt;% ggplot(aes(x = year, y = patients_per_1000_inhabitants, color = country)) + geom_path(position = position_dodge(width = 1)) + facet_grid(rows = vars(drug, ATC), cols = vars(age_cat), scales = \u0026quot;free\u0026quot;, drop = T) + theme_light(base_size = 15) + scale_x_continuous(breaks = c(seq(1999, 2019, 10))) + scale_color_manual(values = wes_palette(name = \u0026quot;GrandBudapest1\u0026quot;, type = \u0026quot;discrete\u0026quot;)) + theme(plot.caption = element_text(hjust = 0), legend.position = \u0026quot;bottom\u0026quot;, panel.spacing = unit(0.8, \u0026quot;cm\u0026quot;)) + labs(y = \u0026quot;Female patients\\nper 1,000 women in the population\u0026quot;, title = paste0(title, \u0026quot; utilization in Swedish and Danish women\u0026quot;), subtitle = \u0026quot;aged between 20 and 54 years\u0026quot;) } list_regex \u0026lt;- list(regex_antidepress, regex_antipsych, regex_anxiolyt, regex_sedat) list_title \u0026lt;- list(\u0026quot;Antidepressants\u0026quot;, \u0026quot;Antipsychotics\u0026quot;, \u0026quot;Anxiolytics\u0026quot;, \u0026quot;Sedatives\u0026quot;) list_plots \u0026lt;- map2(list_regex, list_title, ~plot_utilization(data = data, drug_regex = .x, title = .y))  Results list_plots[[1]]  Among Danish women aged between 20 and 54 years, antidepressants utilizatioin was steadily decreasing, while utilization among Swedish women was increasing. In Denmark, 56 women aged between 20-24 and 72 women aged between 35-45 56 per 1000 women in the population received antidepressants prescription.\nlist_plots[[2]]  Antipsychotics utilization was increasing over the years in both Denmark and Sweden. The rates of antipsychotics utilization were higher among Danish women when compared to Swedish women in the same age categories.\nlist_plots[[3]]  Anxiolytics utilization rates were higher among Swedish women. In Denmark, anxiolytics utilization was decreasing since 1999 until 2019 for women in all age categories between 20 and 54 years.\nlist_plots[[4]]  The rates of sedatives utilization were higher for Swedish women when compared with Danish women of the same age groups. Utilization of sedatives among Danish women was below 50 women per 1000 women of the same age group in the population in all investigated age categories. Among Swedish women, the rate of sedatives utilization was below 50 women per 1000 women in the population only for women between 20 and 24 years of age.\nTake home message  Countries similar in many ways may exhibit different data patterns Antidepressants, antipsychotics, anxiolytics, and sedatives utilization among Danish and Swedish women is far from identical  Thanks for tuning in ü§ì\nAll feedback is appreciated ‚úåÔ∏è\n","date":1598745600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1598745600,"objectID":"e2ee55cbc1c16e919e3f1e847c51cdad","permalink":"/post/drug-utilization-part-ii/2020-08-30-drug-utilization-in-sweden-and-denmark-part-ii/","publishdate":"2020-08-30T00:00:00Z","relpermalink":"/post/drug-utilization-part-ii/2020-08-30-drug-utilization-in-sweden-and-denmark-part-ii/","section":"post","summary":"In this part, I will look into the Danish national trends on of sedatives, antidepressants, anti-psychotics and anxiolytics utilization in women. Then I\u0026rsquo;d like to compare Danish national trends with Swedish national trends from Part I.","tags":["Data analysis","Rstats","tidyverse","drug utilization","pharmacoepidemiology"],"title":"Drug utilization in Sweden and Denmark: Part II","type":"post"},{"authors":["Elena Dudukina","Laura de Smit","Giel J.A. Verhagen","Arie van de Ende","Jos√© Mar√≠a Marim√≥n","Paula Bajanca-Lavado","Carmen Ardanuy","Sara Marti","Marien I. de Jonge","Jeroen D. Langereis"],"categories":null,"content":"","date":1595203200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1595203200,"objectID":"8340a9bf9b0fec04613b7e42ef035ef0","permalink":"/publication/nthi-2020/","publishdate":"2020-07-20T00:00:00Z","relpermalink":"/publication/nthi-2020/","section":"publication","summary":"Vaginal bleeding in early pregnancy is not associated with a higher cancer risk compared with pregnancies in women from the general population of similar age.","tags":["NTHi","Infectious disease","Internship","Immunology"],"title":"Antibody binding and complement-mediated killing of invasive Haemophilus influenzae isolates from Spain, Portugal, and the Netherlands","type":"publication"},{"authors":["Elena Dudukina","Uffe Heide-J√∏rgensen","Edith R. Bahmanyar","Henrik T. S√∏rensen","Vera Ehrenstein"],"categories":null,"content":"","date":1566604800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1566604800,"objectID":"bb30d87bf7fafbc2a29a83ec02cc83c5","permalink":"/publication/icpe-2019/","publishdate":"2019-08-24T00:00:00Z","relpermalink":"/publication/icpe-2019/","section":"publication","summary":"LACEi or ARBs were dispensed in pregnancies with chronic hypertension (590/735, 80.3%), preeclampsia superimposed on chronic hypertension (130/735, 17.7%), and gestational hypertension (15/735, 2.0%). The utilization of ACEi or ARBs for therapy of HDP was low, but not absent.","tags":["Reproductive epidemiology","Poster","Conference","Women's health"],"title":"Hypertensive Disorders Of Pregnancy And Utilization Of Antihypertensive Therapies","type":"publication"},{"authors":["Elena Dudukina","D√≥ra K. Farkas","Erzs√©bet Horv√°th-Puh√≥","Paolo Prandoni","Henrik T. S√∏rensen","Vera Ehrenstein"],"categories":null,"content":"","date":1559347200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1559347200,"objectID":"574f27ddcdefa154c4acc73b9eb07e34","permalink":"/publication/vaginal-bleeding-in-early-pregnancy-and-risk-of-occult-cancer/","publishdate":"2019-06-01T00:00:00Z","relpermalink":"/publication/vaginal-bleeding-in-early-pregnancy-and-risk-of-occult-cancer/","section":"publication","summary":"Vaginal bleeding in early pregnancy is not associated with a higher cancer risk compared with pregnancies in women from the general population of similar age.","tags":["Reproductive epidemiology","Poster","Conference","Women's health"],"title":"Vaginal bleeding in early pregnancy and risk of occult cancer","type":"publication"},{"authors":["E. Dudukina","D. K. Farkas","E. Horv√°th-Puh√≥","P. Prandoni","H. T. S√∏rensen","V. Ehrenstein"],"categories":null,"content":"","date":1522281600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1522281600,"objectID":"d571fd692660c1160a15acc262d3ec56","permalink":"/publication/conference-paper-icthic-2018/","publishdate":"2018-03-29T00:00:00Z","relpermalink":"/publication/conference-paper-icthic-2018/","section":"publication","summary":"We identified 105,277 women with threatened abortion (TA), with a median follow-up of 16.9 years (interquartile range 10.5-24.4 years). During the follow-up, 6,571 women with TA developed cancer. The standardised incidence ratio (SIR) for any cancer was 1.01 (95% CI=0.98-1.03). TA was not associated with an increased risk of cancer of breast (SIR=1.02, 95% CI=0.98-1.07), uterine cervix (SIR=0.93, 95% CI=0.83-1.03), ovary (SIR=0.91, 95% CI=0.78-1.06); or uterus (SIR=0.79, 95% CI=0.66-0.95). TA is not associated with an increased risk of cancer diagnosis.","tags":["Reproductive epidemiology","Poster","Conference","Women's health"],"title":"Threatened abortion and risk of cancer","type":"publication"}]