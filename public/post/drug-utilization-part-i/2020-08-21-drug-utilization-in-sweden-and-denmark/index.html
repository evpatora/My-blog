<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Elena Dudukina">

  
  
  
    
  
  <meta name="description" content="Nordic open access databases Nordic countries have well-sustained healthcare databases with national aggregated data openly available. It is a great asset for research - you can investigate national trends for your curiosity or for research.">

  
  <link rel="alternate" hreflang="en-us" href="/post/drug-utilization-part-i/2020-08-21-drug-utilization-in-sweden-and-denmark/">

  


  
  
  
  <meta name="theme-color" content="#d1641b">
  

  
  

  
  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu25a29b30aca57b666d5aaf9b4d160195_14288_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu25a29b30aca57b666d5aaf9b4d160195_14288_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/post/drug-utilization-part-i/2020-08-21-drug-utilization-in-sweden-and-denmark/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@evpatora">
  <meta property="twitter:creator" content="@evpatora">
  
  <meta property="og:site_name" content="Elena Dudukina">
  <meta property="og:url" content="/post/drug-utilization-part-i/2020-08-21-drug-utilization-in-sweden-and-denmark/">
  <meta property="og:title" content="Drug utilization in Sweden and Denmark: Part I | Elena Dudukina">
  <meta property="og:description" content="Nordic open access databases Nordic countries have well-sustained healthcare databases with national aggregated data openly available. It is a great asset for research - you can investigate national trends for your curiosity or for research."><meta property="og:image" content="/images/icon_hu25a29b30aca57b666d5aaf9b4d160195_14288_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hu25a29b30aca57b666d5aaf9b4d160195_14288_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-08-30T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-08-30T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/drug-utilization-part-i/2020-08-21-drug-utilization-in-sweden-and-denmark/"
  },
  "headline": "Drug utilization in Sweden and Denmark: Part I",
  
  "datePublished": "2020-08-30T00:00:00Z",
  "dateModified": "2020-08-30T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Elena Dudukina"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Elena Dudukina",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/icon_hu25a29b30aca57b666d5aaf9b4d160195_14288_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "Nordic open access databases Nordic countries have well-sustained healthcare databases with national aggregated data openly available. It is a great asset for research - you can investigate national trends for your curiosity or for research."
}
</script>

  

  


  
  
  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.1/cookieconsent.min.js" integrity="sha256-5VhCqFam2Cn+yjw61zbBNrbHVJ6SRydPeKopYlngbiQ=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.1/cookieconsent.min.css" integrity="sha256-zQ0LblD/Af8vOppw18+2anxsuaz3pWYyVWi+bTvTH8Q=" crossorigin="anonymous">
  
  <script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#d1641b",
          "text": "rgb(255, 255, 255)"
        },
        "button": {
          "background": "rgb(255, 255, 255)",
          "text": "#d1641b"
        }
      },
      "theme": "classic",
      "content": {
        "message": "This website uses cookies to ensure you get the best experience on our website.",
        "dismiss": "Got it!",
        "link": "Learn more",
        "href": "/privacy/"
      }
    })});
  </script>



  





  <title>Drug utilization in Sweden and Denmark: Part I | Elena Dudukina</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class=" ">

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Elena Dudukina</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Elena Dudukina</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/cv.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>



  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Drug utilization in Sweden and Denmark: Part I</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    2020-08-30
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    8 min read
  </span>
  

  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="nordic-open-access-databases" class="section level1">
<h1>Nordic open access databases</h1>
<p>Nordic countries have well-sustained healthcare databases with national aggregated data openly available. It is a great asset for research - you can investigate national trends for your curiosity or for research.</p>
<p>The databases are easily accessible and well-maintained. In this blog post (Part I), I will be taking a look into the Swedish drug utilization database.</p>
</div>
<div id="why-i-wrote-this-post" class="section level1">
<h1>Why I wrote this post?</h1>
<p>Despite a bunch of great features, these databases have a web interface that is not always sufficiently flexible to satisfy certain research task. Ticking boxes of the web interface is fun but - oh no - I selected one age category more than I needed, start again…🙈 It can be frustrating when you need a quick and efficient check 👀</p>
</div>
<div id="what-this-post-will-cover" class="section level1">
<h1>What this post will cover?</h1>
<p>This post will be about Swedish national trends of sedatives, antidepressants, anti-psychotics and anxiolytics utilization in women. I also want to compare Swedish and Danish national trends of utilization of these medications in part II.</p>
<p>Let’s go!🇸🇪</p>
<pre class="r"><code>library(tidyverse)
library(magrittr)
library(wesanderson)</code></pre>
<pre class="r"><code># I will keep only ATC codes I am interested in
regex_sedat &lt;- &quot;^N05C$&quot;
regex_antidepress &lt;- &quot;^N06A$&quot;
regex_antipsych &lt;- &quot;^N05A$&quot;
regex_anxiolyt &lt;- &quot;^N05B$&quot;

# combine all ATC codes in one regex string
all_regex &lt;- paste(regex_sedat, regex_antipsych, regex_antidepress, regex_anxiolyt, sep = &quot;|&quot;)</code></pre>
<p>Download zip file “CSV Statistics Database - Medicines 2006–2019” data using <a href="https://sdb.socialstyrelsen.se/export/csv/statistikdatabasen-lakemedel.zip">this</a> link.</p>
<p>Let’s have a look at the data files:</p>
<pre class="r"><code># I&#39;d like to name the list elements according the name of downloaded .csv files
# path_se is your path with the downloaded and unzipped files
file_names_se &lt;- list.files(path = path_se, pattern = &quot;.csv&quot;)

# load files
all_files_se &lt;- map(file_names_se, ~read_delim(file = paste0(path_se, .x), trim_ws = T, delim = &quot;;&quot;)) %&gt;%
  # I expect that formatting of numbers in the files may not be standard; all columns to character type to deal with it later
  map(~mutate_all(.x, as.character))</code></pre>
<p>The files containing the drug utilization per year include columns:</p>
<ul>
<li>Characteristic</li>
<li>Year</li>
<li>Region</li>
<li>ATC</li>
<li>Sex</li>
<li>Age</li>
<li>Value</li>
</ul>
<pre class="r"><code>all_files_se[[1]] %&gt;% slice(1:5)</code></pre>
<pre><code>## # A tibble: 5 x 7
##   Mått  År    Region `ATC­kod` Kön   Ålder Värde 
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 3     2006  0      TOTALT   1     1     560858
## 2 3     2006  0      TOTALT   1     2     413587
## 3 3     2006  0      TOTALT   1     3     415480
## 4 3     2006  0      TOTALT   1     4     474248
## 5 3     2006  0      TOTALT   1     5     444933</code></pre>
<pre class="r"><code># Note the region coded as integer 0, 1, 2</code></pre>
<p>Before moving forward, I want to join drug utilization data with meta-data files.</p>
<pre class="r"><code># age
all_files_se[[71]] %&gt;% slice(1:5)</code></pre>
<pre><code>## # A tibble: 5 x 2
##   Ålder Text 
##   &lt;chr&gt; &lt;chr&gt;
## 1 1     0-4  
## 2 2     5-9  
## 3 3     10-14
## 4 4     15-19
## 5 5     20-24</code></pre>
<pre class="r"><code># ATC codes
all_files_se[[72]] %&gt;% slice(1:5)</code></pre>
<pre><code>## # A tibble: 5 x 2
##   ATC    Text                                  
##   &lt;chr&gt;  &lt;chr&gt;                                 
## 1 TOTALT Samtliga (A - V)                      
## 2 A      Matsmältningsorgan och ämnesomsättning
## 3 A01    Medel vid mun- och tandsjukdomar      
## 4 A01A   Medel vid mun- och tandsjukdomar      
## 5 A01AA  Medel mot karies</code></pre>
<pre class="r"><code># Sex
all_files_se[[73]] %&gt;% slice(1:5)</code></pre>
<pre><code>## # A tibble: 3 x 2
##   Kön   Text      
##   &lt;chr&gt; &lt;chr&gt;     
## 1 1     Män       
## 2 2     Kvinnor   
## 3 3     Båda könen</code></pre>
<pre class="r"><code># Characteristic/stats
all_files_se[[74]] %&gt;% slice(1:5)</code></pre>
<pre><code>## # A tibble: 5 x 2
##   Mått  Text                       
##   &lt;chr&gt; &lt;chr&gt;                      
## 1 1     Antal patienter            
## 2 2     Patienter/1000 invånare    
## 3 3     Antal expedieringar        
## 4 4     Expedieringar/1000 invånare
## 5 9     Befolkning</code></pre>
<pre class="r"><code># Region
all_files_se[[75]] %&gt;% slice(1:5)</code></pre>
<pre><code>## # A tibble: 5 x 2
##   Region Text             
##   &lt;chr&gt;  &lt;chr&gt;            
## 1 00     Riket            
## 2 01     Stockholms län   
## 3 03     Uppsala län      
## 4 04     Södermanlands län
## 5 05     Östergötlands län</code></pre>
<pre class="r"><code># Note the region coded as 00, 01, 02</code></pre>
<p>I am not speaking Swedish and it takes a moment to remember what some of the columns mean and which values are sensible.</p>
<pre class="r"><code># recode regions so that the coding matches the meta-data file
all_files_se[[75]] %&lt;&gt;% mutate(Region = as.character(as.numeric(Region)))</code></pre>
<pre class="r"><code># join with meta-data
data_se &lt;- bind_rows(all_files_se[c(1:70)]) %&gt;% 
  # join with age groups labels
  left_join(all_files_se[[71]]) %&gt;% 
  # rename joined column to age_group
  rename(age_group = Text) %&gt;% 
  # rename ATCkod to ATC
  rename(ATC = 4) %&gt;% 
  # keep only ATC codes of interest
  filter(str_detect(string = ATC, pattern = all_regex)) %&gt;% 
  # join with drugs labels
  left_join(all_files_se[[72]]) %&gt;% 
  # rename joined column
  rename(drug = Text) %&gt;% 
  # join with sex labels
  left_join(all_files_se[[73]]) %&gt;% 
  # rename joined column
  rename(gender = Text) %&gt;% 
  # keep records of drug utilization in women
  filter(gender == &quot;Kvinnor&quot;) %&gt;% 
  # join with characteristics labels
  left_join(all_files_se[[74]]) %&gt;% 
  # rename characteristics labels column
  rename(stat = Text) %&gt;% 
  # join with regions&#39; labels column
  left_join(all_files_se[[75]]) %&gt;% 
  # rename regions&#39; labels column
  rename(region_text = Text) %&gt;% 
  # keep stats for the whole country
  filter(region_text == &quot;Riket&quot;) %&gt;% 
  # rename some of the columns in the dataset while selecting columns in the desired order
  select(year = År,
         region = region_text,
         ATC,
         values = Värde,
         age_group,
         drug,
         gender,
         stat)</code></pre>
<pre class="r"><code>data_se %&gt;% slice(1:5)</code></pre>
<pre><code>## # A tibble: 5 x 8
##   year  region ATC   values age_group drug         gender  stat               
##   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;              
## 1 2006  Riket  N05A  3      0-4       Neuroleptika Kvinnor Antal expedieringar
## 2 2006  Riket  N05A  138    5-9       Neuroleptika Kvinnor Antal expedieringar
## 3 2006  Riket  N05A  922    10-14     Neuroleptika Kvinnor Antal expedieringar
## 4 2006  Riket  N05A  6276   15-19     Neuroleptika Kvinnor Antal expedieringar
## 5 2006  Riket  N05A  13139  20-24     Neuroleptika Kvinnor Antal expedieringar</code></pre>
<pre class="r"><code># pivot data into wide format so that each stat has its column
data_se %&lt;&gt;% pivot_wider(names_from = stat, values_from = values) %&gt;%
  # format numbers in European format, with dot as a decimal separator
  mutate(
    `Expedieringar/1000 invånare` = str_replace_all(string = `Expedieringar/1000 invånare`, pattern = &quot;,&quot;, replacement = &quot;.&quot;),
    `Patienter/1000 invånare` = str_replace_all(string = `Patienter/1000 invånare`, pattern = &quot;,&quot;, replacement = &quot;.&quot;),
    `Expedieringar/1000 invånare` = as.numeric(`Expedieringar/1000 invånare`),
    `Patienter/1000 invånare` = as.numeric(`Patienter/1000 invånare`)
  ) %&gt;% 
  # all to numeric
  mutate_at(vars(`Antal expedieringar`, `Antal patienter`, Befolkning, year), as.numeric)

data_se %&gt;% slice(1:5)</code></pre>
<pre><code>## # A tibble: 5 x 11
##    year region ATC   age_group drug  gender `Antal expedier… `Antal patiente…
##   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt;            &lt;dbl&gt;
## 1  2006 Riket  N05A  0-4       Neur… Kvinn…                3                2
## 2  2006 Riket  N05A  5-9       Neur… Kvinn…              138               39
## 3  2006 Riket  N05A  10-14     Neur… Kvinn…              922              222
## 4  2006 Riket  N05A  15-19     Neur… Kvinn…             6276             1209
## 5  2006 Riket  N05A  20-24     Neur… Kvinn…            13139             2102
## # … with 3 more variables: Befolkning &lt;dbl&gt;, `Expedieringar/1000
## #   invånare` &lt;dbl&gt;, `Patienter/1000 invånare` &lt;dbl&gt;</code></pre>
<p>I will work with age categories between 16 and 49 years.</p>
<pre class="r"><code># age categories
ages_to_keep &lt;- data_se %&gt;% 
  distinct(age_group) %&gt;% 
  filter(row_number() %in% 5:11) %&gt;% 
  pull()

ages_to_keep</code></pre>
<pre><code>## [1] &quot;20-24&quot; &quot;25-29&quot; &quot;30-34&quot; &quot;35-39&quot; &quot;40-44&quot; &quot;45-49&quot; &quot;50-54&quot;</code></pre>
<pre class="r"><code># age_cat_1
age_cat_1 &lt;- data_se %&gt;% 
  distinct(age_group) %&gt;% 
  filter(row_number() %in% 5) %&gt;% 
  pull()

age_cat_1</code></pre>
<pre><code>## [1] &quot;20-24&quot;</code></pre>
<pre class="r"><code># age_cat_2
age_cat_2 &lt;- data_se %&gt;% 
  distinct(age_group) %&gt;% 
  filter(row_number() %in% 6:7) %&gt;% 
  pull()

age_cat_2</code></pre>
<pre><code>## [1] &quot;25-29&quot; &quot;30-34&quot;</code></pre>
<pre class="r"><code># age_cat_3
age_cat_3 &lt;- data_se %&gt;% 
  distinct(age_group) %&gt;% 
  filter(row_number() %in% 8:9) %&gt;% 
  pull()

age_cat_3</code></pre>
<pre><code>## [1] &quot;35-39&quot; &quot;40-44&quot;</code></pre>
<pre class="r"><code># age_cat_4
age_cat_4 &lt;- data_se %&gt;% 
  distinct(age_group) %&gt;% 
  filter(row_number() %in% 10:11) %&gt;% 
  pull()

age_cat_4</code></pre>
<pre><code>## [1] &quot;45-49&quot; &quot;50-54&quot;</code></pre>
<pre class="r"><code># final data
data_se %&lt;&gt;%
  filter(age_group %in% ages_to_keep) %&gt;%
  # group by year and ATC code to aggregate into age categories
  mutate(
    age_cat = case_when(
      age_group %in% age_cat_1 ~ &quot;20-24&quot;,
      age_group %in% age_cat_2 ~ &quot;25-34&quot;,
      age_group %in% age_cat_3 ~ &quot;35-44&quot;,
      age_group %in% age_cat_4 ~ &quot;45-54&quot;,
      T ~ NA_character_
    )
  ) %&gt;% 
  group_by(ATC, year, age_cat) %&gt;% 
  mutate(
    numerator = sum(`Antal patienter`),
    denominator = sum(Befolkning),
    patients_per_1000_inhabitants = numerator / denominator * 1000
  ) %&gt;% 
  ungroup() %&gt;% 
  filter(complete.cases(age_cat)) %&gt;% 
  # keep needed ATC codes only
  filter(str_detect(string = ATC, pattern = all_regex))

data_se %&gt;% slice(1:5)</code></pre>
<pre><code>## # A tibble: 5 x 15
##    year region ATC   age_group drug  gender `Antal expedier… `Antal patiente…
##   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt;            &lt;dbl&gt;
## 1  2006 Riket  N05A  20-24     Neur… Kvinn…            13139             2102
## 2  2006 Riket  N05A  25-29     Neur… Kvinn…            19561             2539
## 3  2006 Riket  N05A  30-34     Neur… Kvinn…            27854             3330
## 4  2006 Riket  N05A  35-39     Neur… Kvinn…            40778             4148
## 5  2006 Riket  N05A  40-44     Neur… Kvinn…            57630             5328
## # … with 7 more variables: Befolkning &lt;dbl&gt;, `Expedieringar/1000
## #   invånare` &lt;dbl&gt;, `Patienter/1000 invånare` &lt;dbl&gt;, age_cat &lt;chr&gt;,
## #   numerator &lt;dbl&gt;, denominator &lt;dbl&gt;, patients_per_1000_inhabitants &lt;dbl&gt;</code></pre>
<pre class="r"><code># a wrapper around the plotting function
plot_se_utilization &lt;- function(data, pattern, name){
  plot_se &lt;- data_se %&gt;% 
  filter(str_detect(string = ATC, pattern = pattern)) %&gt;% 
  ggplot(aes(x = year, y = patients_per_1000_inhabitants, color = age_cat)) +
  geom_path(position = position_dodge(width = 1)) +
  facet_grid(rows = vars(ATC), cols = vars(age_cat), scales = &quot;free&quot;, drop = T) +
  theme_light(base_size = 15) +
  scale_color_manual(values = wes_palette(name = &quot;GrandBudapest2&quot;)) +
  scale_x_continuous(breaks = c(seq(2006, 2018, 6))) +
  theme(plot.caption = element_text(hjust = 0),
        legend.position = &quot;none&quot;) +
  labs(y = &quot;Number of female patients\nper 1,000 women in the population&quot;, title = paste0(name, &quot; utilization in Swedish women&quot;), subtitle = &quot;aged between 20 and 54 years, 2006-2019&quot;)

  plot_se
}

list_regex &lt;- list(regex_antidepress, regex_antipsych, regex_anxiolyt, regex_sedat)

list_names &lt;- list(&quot;Antidepressants&quot;, &quot;Antipsychotics&quot;, &quot;Anxiolytics&quot;, &quot;Sedatives&quot;)

list_plots_se &lt;- map2(list_regex, list_names, ~plot_se_utilization(data = data_se, pattern = .x, name = .y))

list_plots_se</code></pre>
<pre><code>## [[1]]</code></pre>
<p><img src="/post/2020-08-21-drug-utilization-in-Sweden-and-Denmark_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="/post/2020-08-21-drug-utilization-in-Sweden-and-Denmark_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<pre><code>## 
## [[3]]</code></pre>
<p><img src="/post/2020-08-21-drug-utilization-in-Sweden-and-Denmark_files/figure-html/unnamed-chunk-11-3.png" width="672" /></p>
<pre><code>## 
## [[4]]</code></pre>
<p><img src="/post/2020-08-21-drug-utilization-in-Sweden-and-Denmark_files/figure-html/unnamed-chunk-11-4.png" width="672" /></p>
</div>
<div id="data-caveats" class="section level1">
<h1>Data caveats</h1>
<ul>
<li>The data do not include medicines that are sold without a prescription</li>
<li>No data on indication. Medication with the same ATC code with distinct indications will be aggregated and recorded under its ATC code</li>
<li>“Number of patients” is the number of individuals who received a drug prescription at least once during the calendar year (not the number of unique drug users). For some medications, the “number of patients” can exceed the actual size of the given population</li>
<li>The same individual may receive several prescriptions and therefore when summing over several drug groups, the same individual may be counted twice. There’s no way of knowing this because the data is aggregated</li>
</ul>
<p>The whole list of aggregated data caveats to keep in mind for Swedish drug utilization data are listed <a href="https://sdb.socialstyrelsen.se/pages/listinfo.aspx?amne=lak&amp;id=TOLKA">here</a>.</p>
<p>Please leave your comments or questions via your preferred social media. All feedback is very much appreciated ✌️</p>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/data-analysis/">Data analysis</a>
  
  <a class="badge badge-light" href="/tag/rstats/">Rstats</a>
  
  <a class="badge badge-light" href="/tag/tidyverse/">tidyverse</a>
  
  <a class="badge badge-light" href="/tag/drug-utilization/">drug utilization</a>
  
  <a class="badge badge-light" href="/tag/pharmacoepidemiology/">pharmacoepidemiology</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/drug-utilization-part-i/2020-08-21-drug-utilization-in-sweden-and-denmark/&amp;text=Drug%20utilization%20in%20Sweden%20and%20Denmark:%20Part%20I" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/drug-utilization-part-i/2020-08-21-drug-utilization-in-sweden-and-denmark/&amp;t=Drug%20utilization%20in%20Sweden%20and%20Denmark:%20Part%20I" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Drug%20utilization%20in%20Sweden%20and%20Denmark:%20Part%20I&amp;body=/post/drug-utilization-part-i/2020-08-21-drug-utilization-in-sweden-and-denmark/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/drug-utilization-part-i/2020-08-21-drug-utilization-in-sweden-and-denmark/&amp;title=Drug%20utilization%20in%20Sweden%20and%20Denmark:%20Part%20I" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Drug%20utilization%20in%20Sweden%20and%20Denmark:%20Part%20I%20/post/drug-utilization-part-i/2020-08-21-drug-utilization-in-sweden-and-denmark/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/drug-utilization-part-i/2020-08-21-drug-utilization-in-sweden-and-denmark/&amp;title=Drug%20utilization%20in%20Sweden%20and%20Denmark:%20Part%20I" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
  





  
    
    
    
      
    
    
    
    <div class="media author-card content-widget-hr">
      
        
        <img class="avatar mr-3 avatar-circle" src="/author/elena-dudukina/avatar_hub94ed909de68ef2f7bd91a471236bb47_211159_270x270_fill_q90_lanczos_center.jpg" alt="Elena Dudukina">
      

      <div class="media-body">
        <h5 class="card-title"><a href="/">Elena Dudukina</a></h5>
        <h6 class="card-subtitle">PhD student in Epidemiology</h6>
        <p class="card-text">I am interested in women&rsquo;s health, reproductive epidemiology, pharmacoepidemiology, causal inference, directed acyclic graphs, and R stats.</p>
        <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/evpatora" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/evpatora" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=jIw5tCMAAAAJ&amp;hl=en" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://orcid.org/0000-0002-4238-049X" target="_blank" rel="noopener">
        <i class="ai ai-orcid"></i>
      </a>
    </li>
  
</ul>

      </div>
    </div>
  














  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/drug-utilization-part-ii/2020-08-30-drug-utilization-in-sweden-and-denmark-part-ii/">Drug utilization in Sweden and Denmark: Part II</a></li>
      
    </ul>
  </div>
  





  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js" integrity="sha512-7t8APmYpzEsZP7CYoA7RfMPV9Bb+PJHa9x2WiUnDXZx3XHveuyWUtvNOexhkierl5flZ3tr92dP1mMS+SGlD+A==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.3b2b658c61ebd725bd5fc606c89fe44c.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    ©2020
  </p>

  
  





  
  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">
      <img src="https://search.creativecommons.org/static/img/cc_icon.svg" alt="CC icon">
      <img src="https://search.creativecommons.org/static/img/cc-by_icon.svg" alt="CC by icon">
      
        <img src="https://search.creativecommons.org/static/img/cc-nc_icon.svg" alt="CC NC icon">
      
      
        <img src="https://search.creativecommons.org/static/img/cc-nd_icon.svg" alt="CC ND icon">
      
    </a>
  </p>




  <p class="powered-by">
    
    Published with
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic Website Builder</a>
    

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
